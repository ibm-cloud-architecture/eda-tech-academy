<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jerome Boyer"><link href=../eepm/ rel=prev><link href=../../demo/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.6"><title>Mirror maker 2 lab - EDA technical academy</title><link rel=stylesheet href=../../assets/stylesheets/main.558e4712.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#configuring-and-running-mirrormaker-2-mm2 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="EDA technical academy" class="md-header__button md-logo" aria-label="EDA technical academy" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EDA technical academy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Mirror maker 2 lab </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ibm-cloud-architecture/eda-tech-academy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../../eda/ class=md-tabs__link> Information </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> Journey 1 </a> </li> <li class=md-tabs__item> <a href=../../lab1/ class=md-tabs__link> Journey 2 </a> </li> <li class=md-tabs__item> <a href=../../future/ class=md-tabs__link> More... </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="EDA technical academy" class="md-nav__button md-logo" aria-label="EDA technical academy" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> EDA technical academy </label> <div class=md-nav__source> <a href=https://github.com/ibm-cloud-architecture/eda-tech-academy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 tabindex=0 aria-expanded=false> Information <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Information data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Information </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../eda/ class=md-nav__link> Why EDA now? </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/refarch-eda/concepts/fit-to-purpose/ class=md-nav__link> Fit for purpose </a> </li> <li class=md-nav__item> <a href=https://ibm-cloud-architecture.github.io/refarch-eda/introduction/reference-architecture/#event-driven-architecture class=md-nav__link> EDA Reference Architecture </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 tabindex=0 aria-expanded=true> Journey 1 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Journey 1" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Journey 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> Getting started with Event Streams </a> </li> <li class=md-nav__item> <a href=../schema-lab/ class=md-nav__link> Event Streams schema </a> </li> <li class=md-nav__item> <a href=../eepm/ class=md-nav__link> Event-endpoint management </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Mirror maker 2 lab <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Mirror maker 2 lab </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#lab-objectives class=md-nav__link> Lab Objectives </a> </li> <li class=md-nav__item> <a href=#pre-requisites class=md-nav__link> Pre-Requisites </a> </li> <li class=md-nav__item> <a href=#understanding-mirrormaker-2-mm2 class=md-nav__link> Understanding MirrorMaker 2 (MM2) </a> </li> <li class=md-nav__item> <a href=#lab-procedures class=md-nav__link> Lab Procedures </a> <nav class=md-nav aria-label="Lab Procedures"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-take-note-of-source-kafka-topic-details class=md-nav__link> 1. Take note of source Kafka topic details. </a> </li> <li class=md-nav__item> <a href=#2-take-note-of-your-kafkaconnect_url class=md-nav__link> 2. Take note of your KafkaConnect_URL. </a> </li> <li class=md-nav__item> <a href=#3-kafka-connect class=md-nav__link> 3. Kafka Connect </a> </li> <li class=md-nav__item> <a href=#4-mm2-connector-definitions class=md-nav__link> 4. MM2 Connector Definitions </a> </li> <li class=md-nav__item> <a href=#5-mm2-connector-deployment class=md-nav__link> 5. MM2 connector deployment </a> </li> <li class=md-nav__item> <a href=#6-verify-topic-creation class=md-nav__link> 6. Verify topic creation </a> </li> <li class=md-nav__item> <a href=#7-create-mm2-checkpoint class=md-nav__link> 7. Create MM2 Checkpoint </a> </li> <li class=md-nav__item> <a href=#8-check-consumer-lag class=md-nav__link> 8. Check consumer Lag. </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../demo/ class=md-nav__link> Demonstration A to Z </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 tabindex=0 aria-expanded=false> Journey 2 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Journey 2" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Journey 2 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 tabindex=0 aria-expanded=false> Lab 1 - System Design Lab <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Lab 1 - System Design Lab" data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Lab 1 - System Design Lab </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lab1/ class=md-nav__link> Problem Statement </a> </li> <li class=md-nav__item> <a href=../../lab1/lab1-sol/ class=md-nav__link> Solution Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 tabindex=0 aria-expanded=false> Kafka Streams Lab <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Kafka Streams Lab" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Kafka Streams Lab </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lab2/kstream/ class=md-nav__link> Kafka Streams Study </a> </li> <li class=md-nav__item> <a href=../../lab2/ class=md-nav__link> Lab 2 exercises </a> </li> <li class=md-nav__item> <a href=../../lab2/lab2-sol/ class=md-nav__link> Solution Overview </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../lab3/ class=md-nav__link> Lab 3 - Real Time Inventory demo </a> </li> <li class=md-nav__item> <a href=../../lab4/ class=md-nav__link> Lab 4 - EDA GitOps </a> </li> <li class=md-nav__item> <a href=../../lab5/ class=md-nav__link> Lab 5 - Monitoring with Instana </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../future/ class=md-nav__link> More... </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#lab-objectives class=md-nav__link> Lab Objectives </a> </li> <li class=md-nav__item> <a href=#pre-requisites class=md-nav__link> Pre-Requisites </a> </li> <li class=md-nav__item> <a href=#understanding-mirrormaker-2-mm2 class=md-nav__link> Understanding MirrorMaker 2 (MM2) </a> </li> <li class=md-nav__item> <a href=#lab-procedures class=md-nav__link> Lab Procedures </a> <nav class=md-nav aria-label="Lab Procedures"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-take-note-of-source-kafka-topic-details class=md-nav__link> 1. Take note of source Kafka topic details. </a> </li> <li class=md-nav__item> <a href=#2-take-note-of-your-kafkaconnect_url class=md-nav__link> 2. Take note of your KafkaConnect_URL. </a> </li> <li class=md-nav__item> <a href=#3-kafka-connect class=md-nav__link> 3. Kafka Connect </a> </li> <li class=md-nav__item> <a href=#4-mm2-connector-definitions class=md-nav__link> 4. MM2 Connector Definitions </a> </li> <li class=md-nav__item> <a href=#5-mm2-connector-deployment class=md-nav__link> 5. MM2 connector deployment </a> </li> <li class=md-nav__item> <a href=#6-verify-topic-creation class=md-nav__link> 6. Verify topic creation </a> </li> <li class=md-nav__item> <a href=#7-create-mm2-checkpoint class=md-nav__link> 7. Create MM2 Checkpoint </a> </li> <li class=md-nav__item> <a href=#8-check-consumer-lag class=md-nav__link> 8. Check consumer Lag. </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=configuring-and-running-mirrormaker-2-mm2>Configuring and Running MirrorMaker 2 (MM2)<a class=headerlink href=#configuring-and-running-mirrormaker-2-mm2 title="Permanent link">&para;</a></h1> <p>Rajan Krishnan, IBM</p> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>MirrorMaker2, released as part of Kafka 2.4.0, allows you to mirror multiple clusters and create many replication topologies. Learn all about this awesome new tool and how to reliably and easily mirror clusters.</p> <h2 id=lab-objectives>Lab Objectives<a class=headerlink href=#lab-objectives title="Permanent link">&para;</a></h2> <p>In this lab, we will review the basic concepts of MirrorMaker2. You will demonstrate the ability to migrate a topic from a source Kafka to a destination Kafka platform. You will ensure the migration was successful by checking the main properties of topics and consumers and comparing the source / destination Kafka clusters. </p> <h2 id=pre-requisites>Pre-Requisites<a class=headerlink href=#pre-requisites title="Permanent link">&para;</a></h2> <ul> <li>Working instance of Event Streams.</li> <li>A source Kafka cluster (e.g. Strimzi).</li> </ul> <h2 id=understanding-mirrormaker-2-mm2>Understanding MirrorMaker 2 (MM2)<a class=headerlink href=#understanding-mirrormaker-2-mm2 title="Permanent link">&para;</a></h2> <p>MM2 addresses some of the problems with legacy MM (MM1).</p> <ul> <li>Offset translation –avoid duplicates.</li> <li>Consumer group checkpoints.</li> <li>Topics con figurations synced (e.g. partitions, ACLs).</li> <li>MM2 takes advantage of the Kafka Connect ecosystem. </li> </ul> <p>MM2 has 3 main components / connectors.</p> <ol> <li> <p>MirrorSourceConnector</p> <ul> <li>Replicates remote topics, topic configurations.</li> <li>Emits Offset syncs2</li> </ul> </li> <li> <p>MirrorCheckPointConnector</p> <ul> <li>Consumes offset syncs.</li> <li>Combines offset syncs and consumer offset to emit checkpoint</li> </ul> </li> <li> <p>MirrorHeartBeatConnector</p> <ul> <li>Used for monitoring replication flows. </li> <li>Sends source heartbeats to remote. </li> </ul> </li> </ol> <p><img alt src=../images/lab-4-1.png></p> <p>As part of the lab, we will deploy the Source Connectorand Checkpoint Connector</p> <h2 id=lab-procedures>Lab Procedures<a class=headerlink href=#lab-procedures title="Permanent link">&para;</a></h2> <p>In this lab, we will migrate data from an external Kafka topic to a local Kafka topic in Event Stream. The external Kafka can be Strimzi, Confluent, Opensource Kafka, another Event Stream platform or any other Kafka platform. For the purpose of this lab, we will use a Strimzi Kafka platform. </p> <p>When the lab steps are complete, the following details should be replicated between the source Kafka and destination Kafka:</p> <ul> <li>All the messages in the source kafka topic.</li> <li>Timestamp of messages should be preserved.</li> <li>The consumer groups and the respective lags. Message offset value will not be preserved due to retention policy in source kafka. </li> </ul> <h3 id=1-take-note-of-source-kafka-topic-details>1. Take note of source Kafka topic details.<a class=headerlink href=#1-take-note-of-source-kafka-topic-details title="Permanent link">&para;</a></h3> <p>You can check the status of strimzi topic here:</p> <p><a href=https://kafdrop-rajan-strimzi.rajancluster-sng01-992844b4e64c83c3dbd5e7b5e2da5328-0000.jp-tok.containers.appdomain.cloud/topic/basicuserdata>https://kafdrop-rajan-strimzi.rajancluster-sng01-992844b4e64c83c3dbd5e7b5e2da5328-0000.jp-tok.containers.appdomain.cloud/topic/basicuserdata</a> </p> <p>Take note of the topic name, consumer group, consumer lags and last offset message. </p> <p><img alt src=../images/lab-4-2.png></p> <p><img alt src=../images/lab-4-3.png></p> <h3 id=2-take-note-of-your-kafkaconnect_url>2. Take note of your KafkaConnect_URL.<a class=headerlink href=#2-take-note-of-your-kafkaconnect_url title="Permanent link">&para;</a></h3> <p>Use one of the following KafkaConnect_URL depending on the Openshift Cluster that has been assigned to you</p> <table> <thead> <tr> <th>Host</th> <th>URL</th> </tr> </thead> <tbody> <tr> <td>Ventress</td> <td><a href=https://connect-cp4i-eventstreams.apps.ventress.coc-ibm.com>connect-cp4i-eventstreams.apps.ventress.coc-ibm.com</a></td> </tr> <tr> <td>Cody</td> <td><a href=https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com>connect-cp4i-eventstreams.apps.cody.coc-ibm.com</a></td> </tr> <tr> <td>Finn</td> <td><a href=https://connect-cp4i-eventstreams.apps.finn.coc-ibm.com>connect-cp4i-eventstreams.apps.finn.coc-ibm.com</a></td> </tr> </tbody> </table> <h3 id=3-kafka-connect>3. Kafka Connect<a class=headerlink href=#3-kafka-connect title="Permanent link">&para;</a></h3> <p>Check if Kafka Connect is already setup in the cluster and the MirrorMaker 2 plugins are available. </p> <p>Open a Command Terminal and enter this command. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://&lt;KAFKACONNECT_URL&gt;/connector-plugins
</code></pre></div> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connector-plugins/
</code></pre></div> <p>You should get an output similar to this. </p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>You may use tools like <a href=https://stedolan.github.io/jq/ >jq</a> to format the json output in an easy to read format. </p> </div> <p>Ensure the MirrorMaker related plugins are listed. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=p>[</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=p>{</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=nt>&quot;class&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;org.apache.kafka.connect.file.FileStreamSinkConnector&quot;</span><span class=p>,</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sink&quot;</span><span class=p>,</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>    </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;3.1.1&quot;</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=p>},</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=p>{</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>    </span><span class=nt>&quot;class&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;org.apache.kafka.connect.file.FileStreamSourceConnector&quot;</span><span class=p>,</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;source&quot;</span><span class=p>,</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>    </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;3.1.0&quot;</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=p>},</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=p>{</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>    </span><span class=nt>&quot;class&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;org.apache.kafka.connect.mirror.MirrorCheckpointConnector&quot;</span><span class=p>,</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;source&quot;</span><span class=p>,</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>    </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1&quot;</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=p>},</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=p>{</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>    </span><span class=nt>&quot;class&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;org.apache.kafka.connect.mirror.MirrorHeartbeatConnector&quot;</span><span class=p>,</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;source&quot;</span><span class=p>,</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>    </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1&quot;</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=p>},</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=p>{</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=w>    </span><span class=nt>&quot;class&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;org.apache.kafka.connect.mirror.MirrorSourceConnector&quot;</span><span class=p>,</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;source&quot;</span><span class=p>,</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w>    </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1&quot;</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=p>}</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=p>]</span>
</code></pre></div> <h3 id=4-mm2-connector-definitions>4. MM2 Connector Definitions<a class=headerlink href=#4-mm2-connector-definitions title="Permanent link">&para;</a></h3> <ol> <li> <p>Download the MM2 connectors JSON file sample that will be used for creating connectors.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>curl<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>https://raw.githubusercontent.com/ibm-cloud-architecture/eda-tech-academy/main/tech-jam/mm2_json_files/mm2_source.json<span class=w> </span>&gt;<span class=w> </span>mm2_source.json
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>curl<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>https://raw.githubusercontent.com/ibm-cloud-architecture/eda-tech-academy/main/tech-jam/mm2_json_files/mm2_checkpoint.json<span class=w> </span>&gt;<span class=w> </span>mm2_checkpoint.json
</code></pre></div> <p>You will find 2 json files (<code>mm2_source.json &amp; mm2_checkpoint.json</code>). These 2 files will be used in the next steps. Copy the files to <code>C:\TechJam\EventStreams_Lab\</code> Folder.</p> </li> <li> <p>Create the MM2 source connector JSON file. </p> <p>Edit the sample file <code>mm2_source.json</code> in the <code>C:\TechJam\EventStreams_Lab\</code> Folder. Fill-in the details accordingly. </p> <p>Fields not mentioned in this table can be left to their default values. </p> <table> <thead> <tr> <th>parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td><strong>name</strong></td> <td>Enter your studentID. Example: student60-source</td> </tr> <tr> <td><strong>source.cluster.alias</strong></td> <td>A name that you will give to the source cluster. All replicated topics will have a prefix of this alias.Make sure to use the studentID as the prefix. Example: student60-source</td> </tr> <tr> <td><strong>target.cluster.alias</strong></td> <td>A name that you will give to the target cluster. Make sure to use the studentID as the prefix. Example: student60-target</td> </tr> <tr> <td><strong>source.cluster.bootstrap.servers</strong></td> <td>Kafka Bootstrap URL of the source Strimzi cluster. You can use this. <code>rajancluster-sng01-992844b4e64c83c3dbd5e7b5e2da5328-0000.jp-tok.containers.appdomain.cloud:30719</code></td> </tr> <tr> <td><strong>target.cluster.bootstrap.servers</strong></td> <td>Kafka Bootstrap URL of the target Event Stream Cluster. For the purpose of this lab, we have created a PLAIN connection. <code>es-demo-kafka-bootstrap.cp4i-eventstreams.svc:9092</code></td> </tr> <tr> <td><strong>topics</strong></td> <td>Use the topic called “basicuserdata” that has been created for the purpose of this lab.</td> </tr> </tbody> </table> <p><img alt src=../images/lab-4-4.png></p> <p>This is a sample of how the file should look like. </p> </li> </ol> <h3 id=5-mm2-connector-deployment>5. MM2 connector deployment<a class=headerlink href=#5-mm2-connector-deployment title="Permanent link">&para;</a></h3> <ol> <li> <p>Create a MM2 Source Connector.</p> <p>We will use REST API to create the connector. Open a command prompt. Type this command.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nb>cd</span><span class=w> </span>C:<span class=se>\T</span>echJam<span class=se>\E</span>ventStreams_Lab<span class=se>\</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span>https://&lt;KAFKACONNECT_URL&gt;/connectors<span class=w> </span>--data<span class=w> </span><span class=s2>&quot;@./mm2_source.json&quot;</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1># Example:</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connectors<span class=w> </span>--data<span class=w> </span><span class=s2>&quot;@./mm2_source.json&quot;</span>
</code></pre></div> </li> <li> <p>Check the status of the MM2 connector. From the command prompt, type:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># First Get the connector name from the output. </span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://&lt;KAFKACONNECT_URL&gt;/connectors
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># Example:</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connectors/
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=o>[</span><span class=s2>&quot;cody20&quot;</span><span class=o>]</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=c1># Then, get the status of the connector.</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://&lt;KAFKACONNECT_URL&gt;/connectors/&lt;connector_name&gt;/status
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=c1># Example:</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connectors/cody20/status/
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=o>{</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=s2>&quot;name&quot;</span>:<span class=w> </span><span class=s2>&quot;cody20&quot;</span>,
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=s2>&quot;connector&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>    </span><span class=s2>&quot;state&quot;</span>:<span class=w> </span><span class=s2>&quot;RUNNING&quot;</span>,
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>    </span><span class=s2>&quot;worker_id&quot;</span>:<span class=w> </span><span class=s2>&quot;10.128.0.52:8083&quot;</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=o>}</span>,
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=s2>&quot;tasks&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=w>    </span><span class=o>{</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=w>        </span><span class=s2>&quot;id&quot;</span>:<span class=w> </span><span class=m>0</span>,
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=w>        </span><span class=s2>&quot;state&quot;</span>:<span class=w> </span><span class=s2>&quot;RUNNING&quot;</span>,
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=w>        </span><span class=s2>&quot;worker_id&quot;</span>:<span class=w> </span><span class=s2>&quot;10.128.0.52:8083&quot;</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=w>    </span><span class=o>}</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=o>]</span>,
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;source&quot;</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=o>}</span>
</code></pre></div> </li> </ol> <h3 id=6-verify-topic-creation>6. Verify topic creation<a class=headerlink href=#6-verify-topic-creation title="Permanent link">&para;</a></h3> <ol> <li>Check the EventStreams web console and a new topic should have been created. Look for the replicated topic. The topic should be named as: <code>&lt;SOURCE_CLUSTER_ALIAS&gt;-basicuserdata</code> Example: cody20-source.basicuserdata</li> </ol> <p><img alt src=../images/lab-4-5.png></p> <h3 id=7-create-mm2-checkpoint>7. Create MM2 Checkpoint<a class=headerlink href=#7-create-mm2-checkpoint title="Permanent link">&para;</a></h3> <ol> <li> <p>Create the MM2 Checkpoint connector JSON file. </p> <p>Edit the sample file <code>mm2_checkpoint.json</code> in the <code>C:\TechJam\EventStreams_Lab\</code> Folder. Fill-in the details accordingly. Fields not mentioned in this table can be left to it’s default values. </p> <table> <thead> <tr> <th>parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td><strong>name</strong></td> <td>Enter your studentID-checkpoint. Example: cody20-checkpoint</td> </tr> <tr> <td><strong>source.cluster.alias</strong></td> <td>A name that you will give to the source cluster. All replicated topics will have a prefix of this alias.Make sure to use the studentID as the prefix. Example: cody20-source</td> </tr> <tr> <td><strong>target.cluster.alias</strong></td> <td>A name that you will give to the target cluster. Make sure to use the studentID as the prefix. Example: cody20-target</td> </tr> <tr> <td><strong>source.cluster.bootstrap.servers</strong></td> <td>Kafka Bootstrap URL of the source Strimzi cluster. <code>rajancluster-sng01-992844b4e64c83c3dbd5e7b5e2da5328-0000.jp-tok.containers.appdomain.cloud:30719</code></td> </tr> <tr> <td><strong>target.cluster.bootstrap.servers</strong></td> <td>Kafka Bootstrap URL of the target Event Stream Cluster. For the purpose of this lab, we have created a PLAIN connection. <code>es-demo-kafka-bootstrap.cp4i-eventstreams.svc:9092</code></td> </tr> <tr> <td><strong>groups</strong></td> <td>The consumer groups that has to be replicated. For the purpose of this lab we will replicate all groups in the source Kafka. So, use the value “.*”</td> </tr> </tbody> </table> <p><img alt src=../images/lab-4-6.png></p> <p>This is a sample of how the file should look like. </p> </li> <li> <p>Create a MM2 Checkpoint Connector.</p> <p>We will use REST API to create the connector. Open a command prompt. Type this command.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nb>cd</span><span class=w> </span>C:<span class=se>\T</span>echJam<span class=se>\E</span>ventStreams_Lab<span class=se>\</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span>https://&lt;KAFKACONNECT_URL&gt;/connectors<span class=w> </span>--data<span class=w> </span><span class=s2>&quot;@./mm2_checkpoint.json&quot;</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=c1># Example:</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connectors<span class=w> </span>--data<span class=w> </span><span class=s2>&quot;@./mm2_checkpoint.json&quot;</span>
</code></pre></div> </li> <li> <p>Check the status of the MM2 Checkpoint connector. From the command prompt, type:</p> <p>First Get the connector name from the output. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>&lt;KAFKACONNECT_URL&gt;/connectors
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=c1># Example:</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connectors/
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=o>[</span><span class=s2>&quot;cody20&quot;</span>,<span class=s2>&quot;cody20-checkpoint&quot;</span><span class=o>]</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=c1># Then, get the status of the checkpoint connector.</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://&lt;KAFKACONNECT_URL&gt;/&lt;connector_name&gt;/status
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>Example:
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>curl<span class=w> </span>-ki<span class=w> </span>-X<span class=w> </span>GET<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Accept: application/json&quot;</span><span class=w> </span>https://connect-cp4i-eventstreams.apps.cody.coc-ibm.com/connectors/cody20-checkpoint/status/
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=o>{</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=s2>&quot;name&quot;</span>:<span class=w> </span><span class=s2>&quot;cody20-checkpoint&quot;</span>,
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=s2>&quot;connector&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>    </span><span class=s2>&quot;state&quot;</span>:<span class=w> </span><span class=s2>&quot;RUNNING&quot;</span>,
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>    </span><span class=s2>&quot;worker_id&quot;</span>:<span class=w> </span><span class=s2>&quot;10.128.0.52:8083&quot;</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=o>}</span>,
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=s2>&quot;tasks&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=w>    </span><span class=o>{</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>        </span><span class=s2>&quot;id&quot;</span>:<span class=w> </span><span class=m>0</span>,
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=w>        </span><span class=s2>&quot;state&quot;</span>:<span class=w> </span><span class=s2>&quot;RUNNING&quot;</span>,
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=w>        </span><span class=s2>&quot;worker_id&quot;</span>:<span class=w> </span><span class=s2>&quot;10.128.0.52:8083&quot;</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=w>    </span><span class=o>}</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=o>]</span>,
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;source&quot;</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=o>}</span>
</code></pre></div> </li> </ol> <h3 id=8-check-consumer-lag>8. Check consumer Lag.<a class=headerlink href=#8-check-consumer-lag title="Permanent link">&para;</a></h3> <p>Check consumer lags in Event Streams. </p> <ul> <li>Go to Event Streams home page -&gt; Topics -&gt; Click on the replicated topic -&gt; Click on “Consumer Groups”.</li> </ul> <p>The new consumer group should appear and the offset lag should match with that of strimzi. </p> <p><img alt src=../images/lab-4-7.png></p> <ul> <li>Do a random check on the timestamp of a message. </li> </ul> <p><img alt src=../images/lab-4-8.png></p> <p>Now you can consume the data from the Event Streams cluster. You will only be consuming the remaining messages. </p> <p>Make a copy of the <code>config.properties</code> file. Call it <code>config.properties.mm2</code> Edit the <code>config.properties.mm2</code>file and change the following fields. <br> You will have to create a new SCRAM user, and this time, at the point where you choose consumers, select "All Consumers". </p> <table> <thead> <tr> <th>Field</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td><strong>sasl.jaas.config</strong></td> <td>Use the newly created SCRAM user and password</td> </tr> <tr> <td><strong>enableschemaavro</strong></td> <td>False</td> </tr> <tr> <td><strong>topic</strong></td> <td>The newly replicated topic. Example: student60-source.basicuserdata</td> </tr> <tr> <td><strong>group.id</strong></td> <td>You should use the same Consumer Group as the one that has been replicated. general-strimzi-consumer-v1</td> </tr> </tbody> </table> <p>Run the KafkaClient in consumer mode:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>java<span class=w> </span>-jar<span class=w> </span>KafkaClient.jar<span class=w> </span>consumer<span class=w> </span>config.properties.mm2
</code></pre></div> <p>It should only consume the number of messages as listed in the lags (and not the entire message data in the topic). </p> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.tabs", "navigation.instant", "navigation.sections", "navigation.expand", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.51d95adb.min.js></script> </body> </html>